PYPI_URL = https://pypi.python.org/pypi
tarball = `ls -1rt ./dist/*.tar* | tail -1`

dist: flakes
	python setup.py sdist --formats=bztar
	@echo
	@echo 'Use `make publish` to publish to PyPI.'
	@echo
	@echo Tarball for manual distribution:
	@echo $(tarball)

publish: flakes
	python setup.py sdist --formats=bztar,zip upload -r $(PYPI_URL)

publish-test: flakes
	python setup.py register -r $(PYPI_URL)
	python setup.py sdist --formats=bztar,zip upload -r $(PYPI_URL)

# Set a test PYPI_URL for the publish-test target.
publish-test : PYPI_URL = https://testpypi.python.org/pypi
